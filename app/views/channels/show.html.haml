- content_for :header do
  :javascript
    $.data(document, 'channelId',        "#{@channel.to_param}")
    $.data(document, 'lastMessageId',     #{@messages.try(:last).try(:id) || 0})
    $.data(document, 'lastReadMessageId', #{@messages.try(:last).try(:id) || 0})
    $.data(document, 'users',             #{@channel.users.keys           || []})

.messages
  - @messages.each do |message|
    %div{:id => "message_#{message.id}", :class => "message-holder #{'me' if current_user == message.user}"}
      %div{:class => "message-meta"}
        %span{:class => "message-author"}
          = "#{message.user.name}"
        %span{:class => "message-time"}
          = "at #{message.created_at.strftime("%I:%M%p") }"
      %div{:class => "message-content"}
        = message.content

.sidebar
  .rooms_title Rooms
  .rooms
    - @channels.each do |channel|
      - if channel.id == @channel.id
        %div{:class=>"room", :id => "selected"}= "#{channel.name} (#{channel.users.count})"      
      - else
        %div{:class=>"room"}= "#{channel.name} (#{channel.users.count})"

  .users_title Users Online
  .users
    - @users.each do |user|
      .user
        = "#{user.first_name} #{user.last_name}"
  
-content_for :footer do
  .chatbox
    =form_for([@channel, @message], :remote => true) do |f|  
      =f.hidden_field :channel_id, :value =>  @message.channel_id
      =f.text_area :content, :rows => 20

  .actions   
    =image_tag("sound-on.png", :id => "audio_toggle")
      
